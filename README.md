# insight-donation-analytics
A project to analyse repeat election campaign contributions

Software tools and packages:
----------------------------
This project was built using bash and python scripts
and tested on an ubuntu linux desktop distro.

The versions are listed as follows:

#python -V
 	python 2.7.13

#pip install sortedcontainers
 	Collecting sortedcontainers
	Downloading sortedcontainers-1.5.9-py2.py3-none-any.whl
	Installing collected packages: sortedcontainers
	Successfully installed sortedcontainers-1.5.9

#bash --version
	GNU bash, version 4.4.7(1)-release (x86_64-pc-linux-gnu)
	Copyright (C) 2016 Free Software Foundation, Inc.
	License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>

Directory structure and execution:
----------------------------------
The directory structure of this project is as specified by the coding challenge.
The root has run.sh, input, src and output folders.

To run this project, call run.sh
./run.sh
1)The run.sh is a bash script that calls the src/master_scheduler.py with input arguments
2)The src/master_scheduler.py takes the input/itcont.txt, input/percentile.txt and
output/repeat_donors.txt as input arguments (passed from run.sh)
3)The source scripts print Success! to indicate that the scripts have completed execution.
(If you see errors, most likely they are errors that the code dint catch)

./run.sh
Success! script done executing, pls check output/repeat_donors.txt

(if output/ folder has no repeat_donors.txt when the soutce scripts start executing,
a warning message will be displayed but execution continues as the file is created from scratch.)

./run.sh
Warning, output file location doesnt exist 

Continuing script execution taking default path as /home/divyaven/workspace_div/insight/insight-donation-analytics/output/repeat_donors.txt

Success! script done executing, pls check /home/divyaven/workspace_div/insight/insight-donation-analytics/output/repeat_donors.txt

4)After execution check the repeat_donors.txt to verify output.
5)This project has additional test cases added to the tests/ folder under insight_testsuite.
(results.txt generated by calling run_tests.sh also commited to the github repository)

Code structure:
---------------
The src/ folder has two python scripts - master_scheduler.py and donation_analytics.py

1)The master_scheduler.py validates the input arguments passed from run.sh, checks if input files are valid,
reads the itcont.txt line by line and writes to output/cleaned_ip.txt (validating for input considerations
as mentioned in the coding challenge). This file has records with other_id field empty and valid name,zipcode,
recipient id, donation amount and date fields.

2) The master_scheduler.py also reads the percentile value from percentile.txt and validates the same.
If the cleaned_ip.txt file is empty or the percentile value read from percentile.txt is invalid, this script exits with sys.error

3) The master_scheduler on passing all the input validation tests, calls donation_analytics.py with the following args:
location of cleaned_ip.txt, output/repeat_donors.txt and the percentile value as string.

4) The donation_analytics.py reads the cleaned_ip.txt line by line and writes to the repeat_donors.txt
the required information in the format specified in the coding challenge.
